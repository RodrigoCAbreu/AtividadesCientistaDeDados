setwd("~/ProjetosCientistaDeDados/BigDataRAzure/Cap11")
library(MASS)
dados <- Boston
View(dados)
str(dados)
summary(dados)
any(is.na(dados))
install.packages("neuralnet")
library(neuralnet)
maxs <- apply(dados, 2, max)
mins <- apply(dados, 2, min)
maxs
mins
dados_normalizados <- as.data.frame(scale(dados, center = mins, scale = maxs - mins))
head(dados_normalizados)
install.packages("caTools")
library(caTools)
split = sample.split(dados_normalizados$medv, SplitRatio = 0.70)
treino = subset(dados_normalizados, split == TRUE)
teste = subset(dados_normalizados, split == FALSE)
coluna_nomes <- names(treino)
coluna_nomes
formula <- as.formula(paste("medv ~", paste(coluna_nomes[!coluna_nomes %in% "medv"], collapse = " + ")))
formula
rede_neural <- neuralnet(formula, data = treino, hidden = c(5,3), linear.output = TRUE)
rede_neural <- neuralnet(formula, data = treino, hidden = c(5,3), linear.output = TRUE)
plot(rede_neural)
rede_neural_prev <- compute(rede_neural, teste[1:13])
rede_neural_prev
previsoes <- rede_neural_prev$net.result * (max(dados$medv) - min(dados$medv)) + min(dados$medv)
teste_convert <- (teste$medv) * (max(dados$medv) - min(dados$medv)) + min(dados$medv)
teste_convert
MSE.nn <- sum((teste_convert - previsoes)^2)/nrow(teste)
MSE.nn
MSE.nn <- sum((teste_convert - previsoes)^2)/nrow(teste)
MSE.nn
