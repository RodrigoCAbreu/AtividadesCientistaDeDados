library(DBI)
library(RMySQL)
library("data.table")
library("dplyr")
con = dbConnect(MySQL(), user = "rodrigo.abreu", password = "123mudar", dbname = "etl_plataformas", host = "104.41.32.26")
qry <- "SELECT
calldate,
TRANSACTION,
documento,
scriptpoint,
node,
dnanavegacao,
durationcallcenter,
COUNT(*)
FROM etl_plataformas.`cdrlogdata_bcp` PARTITION(p202011)
WHERE durationcallcenter > 0 AND scriptpoint = 188  -- AND (calldate BETWEEN '2020-08-31 00:00:00' AND '2020-09-08 23:59:59')
GROUP BY 1,2,3"
base <- dbGetQuery(con, qry)
base <- data.table(base)
base1 <- base
View(base1)
amostra <- sample_n(base1, 300)
write.csv2(amostra, file = 'Amostra_SP188.csv')
qry <- "SELECT
calldate,
TRANSACTION,
documento,
scriptpoint,
node,
dnanavegacao,
durationcallcenter,
COUNT(*)
FROM etl_plataformas.`cdrlogdata_bcp` PARTITION(p202011)
WHERE durationcallcenter > 0 AND scriptpoint = 203  -- AND (calldate BETWEEN '2020-08-31 00:00:00' AND '2020-09-08 23:59:59')
GROUP BY 1,2,3"
base <- dbGetQuery(con, qry)
base <- data.table(base)
base1 <- base
View(base1)
qry <- "SELECT
calldate,
TRANSACTION,
documento,
scriptpoint,
node,
dnanavegacao,
durationcallcenter,
COUNT(*)
FROM etl_plataformas.`cdrlogdata_bcp` PARTITION(p202011)
WHERE durationcallcenter > 0 AND scriptpoint = 203  -- AND (calldate BETWEEN '2020-08-31 00:00:00' AND '2020-09-08 23:59:59')
GROUP BY 1,2,3"
base <- dbGetQuery(con, qry)
base <- data.table(base)
base1 <- base
View(base1)
View(amostra)
View(base1)
amostra <- sample_n(base1, 300)
write.csv2(amostra, file = 'Amostra_SP203.csv')
getwd()
setwd("~/AtividadesCientistaDeDados/Machine Learning/Cap08 - Decision Treee, Random Forest e Métodos Ensemble - I/R")
clima <- expand.grid(Tempo = c("Ensolarado","Nublado","Chuvoso"),
Temperatura = c("Quente","Ameno","Frio"),
Humidade = c("Alta","Normal"),
Vento = c("Fraco","Forte"))
View(clima)
response <- c(1, 19, 4, 31, 16, 2, 11, 23, 35, 6, 24, 15, 18, 36)
play <- as.factor(c("Não Jogar", "Não Jogar", "Não Jogar", "Jogar", "Jogar", "Jogar", "Jogar", "Jogar", "Jogar", "Jogar", "Não Jogar", "Jogar", "Jogar", "Não Jogar"))
tennis <- data.frame(clima[response,], play)
View(tennis)
install.packages("rpart")
library(rpart)
tennis_tree <- rpart(play ~ .,
data = tennis,
method = "class",
parms = list(split = "information"),
control = rpart.control(minsplit = 1))
tennis_tree
install.packages("rpart.plot")
library(rpart.plot)
prp(tennis_tree, type = 0, extra = 1, under = TRUE, compress = TRUE)
clima <- expand.grid(Tempo = c("Ensolarado","Nublado","Chuvoso"),
Temperatura = c("Quente","Ameno","Frio"),
Humidade = c("Alta","Normal"),
Vento = c("Fraco","Forte"))
response <- c(2, 20, 3, 33, 17, 4, 5)
novos_dados <- data.frame(clima[response,])
View(novos_dados)
predict(tennis_tree, novos_dados)
